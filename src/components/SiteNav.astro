---
import BookCallLink from './BookCallLink.astro';

const primaryLinks = [
  { href: "/services", label: "Services" },
  { href: "/work", label: "Work" },
  { href: "/pricing", label: "Pricing" },
  { href: "/resources", label: "Resources" },
  { href: "/about", label: "About" }
];

const pathname = Astro.url.pathname;

function isActive(href: string) {
  if (href === "/") return pathname === "/";
  return pathname.startsWith(href);
}
---

<header class="sticky top-0 z-50 border-b border-white/10 bg-ink-900/80 text-white backdrop-blur">
  <nav class="mx-auto flex w-full max-w-6xl items-center gap-4 px-6 py-3 md:gap-6 md:py-4">
    <a href="/" class="flex items-center gap-4" aria-label="BUILD3R home">
      <img
        src="/branding/logo-light.png"
        alt="BUILD3R"
        width="240"
        height="72"
        class="h-12 w-auto shrink-0 md:h-16"
      />
    </a>
    <div class="hidden flex-1 items-center justify-center gap-8 md:flex">
      {primaryLinks.map(({ href, label }) => (
        <a
          href={href}
          data-active={isActive(href)}
          class="group relative text-sm font-medium uppercase tracking-[0.35em] text-white/70 transition hover:text-white after:absolute after:-bottom-3 after:left-1/2 after:h-0.5 after:w-9 after:-translate-x-1/2 after:rounded-full after:bg-brand-blue-400 after:opacity-0 after:content-[''] after:transition data-[active=true]:text-white data-[active=true]:after:opacity-100"
        >
          {label}
        </a>
      ))}
    </div>
    <BookCallLink
      source="nav"
      class="ml-auto hidden rounded-full bg-gradient-to-br from-brand-blue-600 via-brand-purple-600 to-brand-blue-800 px-5 py-2 text-sm font-semibold text-white shadow-soft transition hover:-translate-y-0.5 hover:opacity-95 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-blue-300 focus-visible:ring-offset-2 focus-visible:ring-offset-ink-900 md:inline-flex"
    >
      Book a Call
    </BookCallLink>
    <details class="relative ml-auto md:hidden">
      <summary class="flex cursor-pointer items-center gap-2 rounded-full border border-white/20 px-4 py-2 text-xs font-semibold uppercase tracking-[0.4em] text-white/80 transition hover:border-brand-blue-400 hover:text-white [&::-webkit-details-marker]:hidden">
        Menu
      </summary>
      <div class="pattern-noise absolute right-0 mt-3 w-56 rounded-2xl border border-white/10 bg-ink-900/95 p-4 shadow-soft">
        <nav class="flex flex-col gap-4 text-sm font-medium text-white/80">
          {primaryLinks.map(({ href, label }) => (
            <a
              href={href}
              data-active={isActive(href)}
              class="rounded-lg px-2 py-1 transition hover:bg-white/10 hover:text-white data-[active=true]:bg-white/10 data-[active=true]:text-white"
            >
              {label}
            </a>
          ))}
        </nav>
        <BookCallLink
          source="nav-mobile"
          class="mt-4 inline-flex w-full justify-center rounded-full bg-gradient-to-br from-brand-blue-600 via-brand-purple-600 to-brand-blue-800 px-4 py-2 text-sm font-semibold text-white shadow-soft focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-blue-300"
        >
          Book a Call
        </BookCallLink>
      </div>
    </details>
  </nav>
</header>
